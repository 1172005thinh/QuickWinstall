using System;
using System.IO;
using System.Text.Json;
using QuickWinstall.Lib;

namespace QuickWinstall
{
    public record GlobalConfig(
        int BorderRadius,
        int BorderSize,
        int ButtonBox,
        int ButtonHeight,
        int ButtonTextHeight,
        int ButtonTextWidth,
        int ButtonWidth,
        int CheckboxBox,
        int CheckboxTextHeight,
        int CheckboxTextWidth,
        int ComboboxHeight,
        int ComboboxWidth,
        int ControlPanelButtonHeight,
        int ControlPanelButtonWidth,
        int ControlPanelHeight,
        int ControlPanelWidth,
        int FormHeight,
        int FormHeightMax,
        int FormHeightMin,
        int FormWidthMax,
        int FormWidthMin,
        int FormWidth,
        int IconSize,
        int IconSizeLarge,
        int InfoWarningLabelHeight,
        int InfoWarningLabelWidth,
        int LabelHeight,
        int LabelWidth,
        int Margin,
        int MarginBottom,
        int MarginLeft,
        int MarginRight,
        int MarginTop,
        int Padding,
        int PaddingBottom,
        int PaddingLeft,
        int PaddingRight,
        int PaddingTop,
        int RowHeight,
        int SectionBorderWidth,
        int SectionHeaderHeight,
        int SectionHeaderTextTitleHeight,
        int SectionHeaderTextTitleWidth,
        int SectionHeaderWidth,
        int SectionHeight,
        int SectionMargin,
        int SectionMarginBottom,
        int SectionMarginLeft,
        int SectionMarginRight,
        int SectionMarginTop,
        int SectionPadding,
        int SectionPaddingBottom,
        int SectionPaddingLeft,
        int SectionPaddingRight,
        int SectionPaddingTop,
        int SectionWidth,
        int Spacing,
        int SpacingBottom,
        int SpacingLeft,
        int SpacingRight,
        int SpacingTop,
        int StatusStripHeight,
        int StatusStripWidth,
        int Tab,
        int Tab1,
        int Tab2,
        int Tab3,
        int Tab4,
        int Tab5,
        int TableColumnSpacing,
        int TableColumnWidth,
        int TableHeight,
        int TableRowHeaderHeight,
        int TableRowHeaderWidth,
        int TableRowHeight,
        int TableRowSpacing,
        int TableWidth,
        int TextboxHeight,
        int TextboxWidth);

    public record MainFormConfig(
        int BorderRadius,
        int BorderSize,
        int ButtonBox,
        int ButtonHeight,
        int ButtonTextHeight,
        int ButtonTextWidth,
        int ButtonWidth,
        int CheckboxBox,
        int CheckboxTextHeight,
        int CheckboxTextWidth,
        int ComboboxHeight,
        int ComboboxWidth,
        int ControlPanelButtonHeight,
        int ControlPanelButtonWidth,
        int ControlPanelHeight,
        int ControlPanelWidth,
        int FormHeight,
        int FormHeightMax,
        int FormHeightMin,
        int FormWidth,
        int FormWidthMax,
        int FormWidthMin,
        int IconSize,
        int IconSizeLarge,
        int InfoWarningLabelHeight,
        int InfoWarningLabelWidth,
        int LabelHeight,
        int LabelWidth,
        int Margin,
        int MarginBottom,
        int MarginLeft,
        int MarginRight,
        int MarginTop,
        int Padding,
        int PaddingBottom,
        int PaddingLeft,
        int PaddingRight,
        int PaddingTop,
        int RowHeight,
        int SectionBorderWidth,
        int SectionHeaderHeight,
        int SectionHeaderTextTitleHeight,
        int SectionHeaderTextTitleWidth,
        int SectionHeaderWidth,
        int SectionHeight,
        int SectionGeneralConfigHeight,
        int SectionLangRegionConfigHeight,
        int SectionBypassConfigHeight,
        int SectionDiskConfigHeight,
        int SectionAccountConfigHeight,
        int SectionBitLockerConfigHeight,
        int SectionOOBEConfigHeight,
        int SectionPersonalizeConfigHeight,
        int SectionAppConfigHeight,
        int SectionMargin,
        int SectionMarginBottom,
        int SectionMarginLeft,
        int SectionMarginRight,
        int SectionMarginTop,
        int SectionPadding,
        int SectionPaddingBottom,
        int SectionPaddingLeft,
        int SectionPaddingRight,
        int SectionPaddingTop,
        int SectionWidth,
        int Spacing,
        int SpacingBottom,
        int SpacingLeft,
        int SpacingRight,
        int SpacingTop,
        int StatusStripHeight,
        int StatusStripWidth,
        int Tab,
        int Tab1,
        int Tab2,
        int Tab3,
        int Tab4,
        int Tab5,
        int TableColumnSpacing,
        int TableColumnWidth,
        int TableHeight,
        int TableRowHeaderHeight,
        int TableRowHeaderWidth,
        int TableRowHeight,
        int TableRowSpacing,
        int TableWidth,
        int TextboxHeight,
        int TextboxWidth);
    
    public record SettingsFormConfig(
        int BorderRadius,
        int BorderSize,
        int ButtonBox,
        int ButtonHeight,
        int ButtonTextHeight,
        int ButtonTextWidth,
        int ButtonWidth,
        int CheckboxBox,
        int CheckboxTextHeight,
        int CheckboxTextWidth,
        int ComboboxHeight,
        int ComboboxWidth,
        int ControlPanelButtonHeight,
        int ControlPanelButtonWidth,
        int ControlPanelHeight,
        int ControlPanelWidth,
        int FormHeight,
        int FormHeightMax,
        int FormHeightMin,
        int FormWidth,
        int FormWidthMax,
        int FormWidthMin,
        int IconSize,
        int IconSizeLarge,
        int InfoWarningLabelHeight,
        int InfoWarningLabelWidth,
        int LabelHeight,
        int LabelWidth,
        int Margin,
        int MarginBottom,
        int MarginLeft,
        int MarginRight,
        int MarginTop,
        int Padding,
        int PaddingBottom,
        int PaddingLeft,
        int PaddingRight,
        int PaddingTop,
        int RowHeight,
        int SectionBorderWidth,
        int SectionHeaderHeight,
        int SectionHeaderTextTitleHeight,
        int SectionHeaderTextTitleWidth,
        int SectionHeaderWidth,
        int SectionHeight,
        int SectionMargin,
        int SectionMarginBottom,
        int SectionMarginLeft,
        int SectionMarginRight,
        int SectionMarginTop,
        int SectionPadding,
        int SectionPaddingBottom,
        int SectionPaddingLeft,
        int SectionPaddingRight,
        int SectionPaddingTop,
        int SectionWidth,
        int Spacing,
        int SpacingBottom,
        int SpacingLeft,
        int SpacingRight,
        int SpacingTop,
        int StatusStripHeight,
        int StatusStripWidth,
        int Tab,
        int Tab1,
        int Tab2,
        int Tab3,
        int Tab4,
        int Tab5,
        int TableColumnSpacing,
        int TableColumnWidth,
        int TableHeight,
        int TableRowHeaderHeight,
        int TableRowHeaderWidth,
        int TableRowHeight,
        int TableRowSpacing,
        int TableWidth,
        int TextboxHeight,
        int TextboxWidth);

    public record PresetsFormConfig(
        int BorderRadius,
        int BorderSize,
        int ButtonBox,
        int ButtonHeight,
        int ButtonTextHeight,
        int ButtonTextWidth,
        int ButtonWidth,
        int CheckboxBox,
        int CheckboxTextHeight,
        int CheckboxTextWidth,
        int ComboboxHeight,
        int ComboboxWidth,
        int ControlPanelButtonHeight,
        int ControlPanelButtonWidth,
        int ControlPanelHeight,
        int ControlPanelWidth,
        int FormHeight,
        int FormHeightMax,
        int FormHeightMin,
        int FormWidth,
        int FormWidthMax,
        int FormWidthMin,
        int IconSize,
        int IconSizeLarge,
        int InfoWarningLabelHeight,
        int InfoWarningLabelWidth,
        int LabelHeight,
        int LabelWidth,
        int Margin,
        int MarginBottom,
        int MarginLeft,
        int MarginRight,
        int MarginTop,
        int Padding,
        int PaddingBottom,
        int PaddingLeft,
        int PaddingRight,
        int PaddingTop,
        int RowHeight,
        int SectionBorderWidth,
        int SectionHeaderHeight,
        int SectionHeaderTextTitleHeight,
        int SectionHeaderTextTitleWidth,
        int SectionHeaderWidth,
        int SectionHeight,
        int SectionMargin,
        int SectionMarginBottom,
        int SectionMarginLeft,
        int SectionMarginRight,
        int SectionMarginTop,
        int SectionPadding,
        int SectionPaddingBottom,
        int SectionPaddingLeft,
        int SectionPaddingRight,
        int SectionPaddingTop,
        int SectionWidth,
        int Spacing,
        int SpacingBottom,
        int SpacingLeft,
        int SpacingRight,
        int SpacingTop,
        int StatusStripHeight,
        int StatusStripWidth,
        int Tab,
        int Tab1,
        int Tab2,
        int Tab3,
        int Tab4,
        int Tab5,
        int TableColumnSpacing,
        int TableColumnWidth,
        int TableHeight,
        int TableRowHeaderHeight,
        int TableRowHeaderWidth,
        int TableRowHeight,
        int TableRowSpacing,
        int TableWidth,
        int TextboxHeight,
        int TextboxWidth);        

    public record AboutFormConfig(
        int BorderRadius,
        int BorderSize,
        int ButtonBox,
        int ButtonHeight,
        int ButtonTextHeight,
        int ButtonTextWidth,
        int ButtonWidth,
        int CheckboxBox,
        int CheckboxTextHeight,
        int CheckboxTextWidth,
        int ComboboxHeight,
        int ComboboxWidth,
        int ControlPanelButtonHeight,
        int ControlPanelButtonWidth,
        int ControlPanelHeight,
        int ControlPanelWidth,
        int FormHeight,
        int FormHeightMax,
        int FormHeightMin,
        int FormWidth,
        int FormWidthMax,
        int FormWidthMin,
        int IconSize,
        int IconSizeLarge,
        int InfoWarningLabelHeight,
        int InfoWarningLabelWidth,
        int LabelHeight,
        int LabelWidth,
        int Margin,
        int MarginBottom,
        int MarginLeft,
        int MarginRight,
        int MarginTop,
        int Padding,
        int PaddingBottom,
        int PaddingLeft,
        int PaddingRight,
        int PaddingTop,
        int RowHeight,
        int SectionBorderWidth,
        int SectionHeaderHeight,
        int SectionHeaderTextTitleHeight,
        int SectionHeaderTextTitleWidth,
        int SectionHeaderWidth,
        int SectionHeight,
        int SectionMargin,
        int SectionMarginBottom,
        int SectionMarginLeft,
        int SectionMarginRight,
        int SectionMarginTop,
        int SectionPadding,
        int SectionPaddingBottom,
        int SectionPaddingLeft,
        int SectionPaddingRight,
        int SectionPaddingTop,
        int SectionWidth,
        int Spacing,
        int SpacingBottom,
        int SpacingLeft,
        int SpacingRight,
        int SpacingTop,
        int StatusStripHeight,
        int StatusStripWidth,
        int Tab,
        int Tab1,
        int Tab2,
        int Tab3,
        int Tab4,
        int Tab5,
        int TableColumnSpacing,
        int TableColumnWidth,
        int TableHeight,
        int TableRowHeaderHeight,
        int TableRowHeaderWidth,
        int TableRowHeight,
        int TableRowSpacing,
        int TableWidth,
        int TextboxHeight,
        int TextboxWidth);

    public record HelpFormConfig(
        int BorderRadius,
        int BorderSize,
        int ButtonBox,
        int ButtonHeight,
        int ButtonTextHeight,
        int ButtonTextWidth,
        int ButtonWidth,
        int CheckboxBox,
        int CheckboxTextHeight,
        int CheckboxTextWidth,
        int ComboboxHeight,
        int ComboboxWidth,
        int ControlPanelButtonHeight,
        int ControlPanelButtonWidth,
        int ControlPanelHeight,
        int ControlPanelWidth,
        int FormHeight,
        int FormHeightMax,
        int FormHeightMin,
        int FormWidth,
        int FormWidthMax,
        int FormWidthMin,
        int IconSize,
        int IconSizeLarge,
        int InfoWarningLabelHeight,
        int InfoWarningLabelWidth,
        int LabelHeight,
        int LabelWidth,
        int Margin,
        int MarginBottom,
        int MarginLeft,
        int MarginRight,
        int MarginTop,
        int Padding,
        int PaddingBottom,
        int PaddingLeft,
        int PaddingRight,
        int PaddingTop,
        int RowHeight,
        int SectionBorderWidth,
        int SectionHeaderHeight,
        int SectionHeaderTextTitleHeight,
        int SectionHeaderTextTitleWidth,
        int SectionHeaderWidth,
        int SectionHeight,
        int SectionMargin,
        int SectionMarginBottom,
        int SectionMarginLeft,
        int SectionMarginRight,
        int SectionMarginTop,
        int SectionPadding,
        int SectionPaddingBottom,
        int SectionPaddingLeft,
        int SectionPaddingRight,
        int SectionPaddingTop,
        int SectionWidth,
        int Spacing,
        int SpacingBottom,
        int SpacingLeft,
        int SpacingRight,
        int SpacingTop,
        int StatusStripHeight,
        int StatusStripWidth,
        int Tab,
        int Tab1,
        int Tab2,
        int Tab3,
        int Tab4,
        int Tab5,
        int TableColumnSpacing,
        int TableColumnWidth,
        int TableHeight,
        int TableRowHeaderHeight,
        int TableRowHeaderWidth,
        int TableRowHeight,
        int TableRowSpacing,
        int TableWidth,
        int TextboxHeight,
        int TextboxWidth);

    public class Config
    {
        public GlobalConfig Global { get; init; }
        public AboutFormConfig AboutForm { get; init; }
        public SettingsFormConfig SettingsForm { get; init; }
        public PresetsFormConfig PresetForm { get; init; }
        public HelpFormConfig HelpForm { get; init; }
        public MainFormConfig MainForm { get; init; }

        public static Config Load(string path)
        {
            if (!File.Exists(path))
                throw new FileNotFoundException(LangManager.GetString("DefaultsFileNotFound", "Defaults file not found."), path);
            
            var json = File.ReadAllText(path);
            var opts = new JsonSerializerOptions { PropertyNameCaseInsensitive = true };
            return JsonSerializer.Deserialize<Config>(json, opts)
                ?? throw new InvalidOperationException(LangManager.GetString("FailedToParseDefaults", "Failed to parse defaults."));
        }

        // Convenience: load from application output directory (config.json must be copied to output)
        public static Config LoadFromAppFolder()
        {
            var path = Path.Combine(AppContext.BaseDirectory, "src", "ui","config.json");
            return Load(path);
        }
    }
}
